/*
 * 版权所有 © 成都太阳高科技有限责任公司
 * http://www.suncd.com
 */
package com.suncd.demopdf.Utils;

import com.lowagie.text.pdf.BaseFont;
import freemarker.template.Template;
import freemarker.template.TemplateException;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.util.CollectionUtils;
import org.springframework.web.servlet.view.freemarker.FreeMarkerConfigurer;
import org.w3c.dom.Document;
import org.xhtmlrenderer.pdf.ITextFontResolver;
import org.xhtmlrenderer.pdf.ITextRenderer;

import javax.servlet.ServletOutputStream;
import javax.servlet.http.HttpServletResponse;
import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;
import java.io.*;
import java.util.List;
import java.util.Map;

/**
 * 功能：pdf处理工具类
 *
 * @author qust
 * @version 1.0 2018/2/23 17:21
 */
public class PdfUtils {
    private PdfUtils() {
    }

    private static final Logger LOGGER = LoggerFactory.getLogger(PdfUtils.class);

    /**
     * 按模板和参数生成html字符串
     *
     * @param templateName freemarker模板名称
     * @param variables    freemarker模板参数
     * @return String
     *
     * 解决打包后Windows下调用出现空指针问题
     */
    private static String generateDocString(FreeMarkerConfigurer configurer, String templateName, Object variables){
        StringWriter writer = new StringWriter();
        try {
            Template template = configurer.getConfiguration().getTemplate(templateName);
            template.process(variables, writer);
        }catch (Exception e){
            LOGGER.error(e.getMessage(),e);
        }
        writer.flush();
        return writer.toString();
    }
    /**
     * 按模板和参数生成html字符串,再转换为flying-saucer识别的Document
     *
     * @param templateName freemarker模板名称
     * @param variables    freemarker模板参数
     * @return Document
     *
     * Deprecated暂停使用, 调整为generateDocString()进行生成
     */
    @Deprecated
    private static Document generateDoc(FreeMarkerConfigurer configurer, String templateName, Map<String, Object> variables)  {
        Template tp;
        try {
            tp = configurer.getConfiguration().getTemplate(templateName);
        } catch (IOException e) {
            LOGGER.error(e.getMessage(), e);
            return null;
        }
        StringWriter stringWriter = new StringWriter();
        try(BufferedWriter writer = new BufferedWriter(stringWriter)) {
            try {
                tp.process(variables, writer);
                writer.flush();
            } catch (TemplateException e) {
                LOGGER.error("模板不存在或者路径错误", e);
            } catch (IOException e) {
                LOGGER.error("IO异常", e);
            }
            DocumentBuilder builder = DocumentBuilderFactory.newInstance().newDocumentBuilder();
            return builder.parse(new ByteArrayInputStream(stringWriter.toString().getBytes()));
        }catch (Exception e){
            LOGGER.error(e.getMessage(), e);
            return null;
        }
    }

    /**
     * 核心: 根据freemarker模板生成pdf文档
     *
     * @param configurer   freemarker配置
     * @param templateName freemarker模板名称
     * @param out          输出流
     * @param listVars     freemarker模板参数
     * @throws Exception   模板无法找到、模板语法错误、IO异常
     */
    private static void generateAll(FreeMarkerConfigurer configurer, String templateName, OutputStream out, List<Map<String, Object>> listVars) throws Exception {
        if (CollectionUtils.isEmpty(listVars)) {
            LOGGER.warn("警告:freemarker模板参数为空!");
            return;
        }

        ITextRenderer renderer = new ITextRenderer();
//        Document doc = generateDoc(configurer, templateName, listVars.get(0));

//        组装参数
        CgxVo cgxVo = new CgxVo();
        SubVo subVo = new SubVo();
        subVo.setTitle("cgx title");
        subVo.setImg("data:image/png;base64,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");
        cgxVo.setCgx(subVo);
        String doc = generateDocString(configurer, templateName, cgxVo);
        renderer.setDocumentFromString(doc);
        //设置字符集(宋体),此处必须与模板中的<body style="font-family: SimSun">一致,区分大小写,不能写成汉字"宋体"
        ITextFontResolver fontResolver = (ITextFontResolver)renderer.getSharedContext().getFontResolver();
        fontResolver.addFont("simsun.ttc", BaseFont.IDENTITY_H, BaseFont.NOT_EMBEDDED);
        fontResolver.addFont("GB2312.ttf", BaseFont.IDENTITY_H, BaseFont.NOT_EMBEDDED);
        fontResolver.addFont("fzhtjw.ttf", BaseFont.IDENTITY_H, BaseFont.NOT_EMBEDDED);
        //展现和输出pdf
        renderer.layout();
        renderer.createPDF(out, false);

        //根据参数集个数循环调用模板,追加到同一个pdf文档中
        //(注意:此处从1开始,因为第0是创建pdf,从1往后则向pdf中追加内容)
        for (int i = 1; i < listVars.size(); i++) {
            String docAppend = generateDocString(configurer, templateName, listVars.get(i));
            renderer.setDocumentFromString(docAppend);
            renderer.layout();
            renderer.writeNextDocument(); //写下一个pdf页面
        }
        renderer.finishPDF(); //完成pdf写入
    }

    /**
     * pdf下载
     *
     * @param configurer   freemarker配置
     * @param templateName freemarker模板名称(带后缀.ftl)
     * @param listVars     模板参数集
     * @param response     HttpServletResponse
     * @param fileName     下载文件名称(带文件扩展名后缀)
     */
    public static void download(FreeMarkerConfigurer configurer, String templateName, List<Map<String, Object>> listVars, HttpServletResponse response, String fileName) {
        // 设置编码、文件ContentType类型、文件头、下载文件名
        response.setCharacterEncoding("utf-8");
        response.setContentType("multipart/form-data");
        try {
            response.setHeader("Content-Disposition", "attachment;fileName=" +
                    new String(fileName.getBytes("gb2312"), "ISO8859-1"));
        } catch (UnsupportedEncodingException e) {
            LOGGER.error(e.getMessage(), e);
        }
        try (ServletOutputStream out = response.getOutputStream()) {
            generateAll(configurer, templateName, out, listVars);
            out.flush();
        } catch (Exception e) {
            LOGGER.error(e.getMessage(), e);
        }
    }

    /**
     * pdf预览
     *
     * @param configurer   freemarker配置
     * @param templateName freemarker模板名称(带后缀.ftl)
     * @param listVars     模板参数集
     * @param response     HttpServletResponse
     */
    public static void preview(FreeMarkerConfigurer configurer, String templateName, List<Map<String, Object>> listVars, HttpServletResponse response) {
        try (ServletOutputStream out = response.getOutputStream()) {
            generateAll(configurer, templateName, out, listVars);
            out.flush();
        } catch (Exception e) {
            LOGGER.error(e.getMessage(), e);
        }
    }
}
